<!-- Book Section Component -->
<!-- Parameters expected (set via template variables before including):
     - section_name: "reading", "completed", "abandoned" or "unread"
     - section_title: Display title for the section
     - books: Array of books to display
     - default_visible: boolean for initial visibility
     - gradient_classes: CSS classes for the gradient indicator
     - badge_classes: CSS classes for the badge
-->

<section data-name="{{ section_name }}" data-default-visible="{{ default_visible }}">
    <div class="flex items-center justify-between mb-4 md:mb-6 pb-4 border-b border-gray-200/50 dark:border-dark-700/50">
        <div class="flex items-center space-x-3">
            <div class="w-2 h-6 md:h-8 bg-gradient-to-b {{ gradient_classes }} rounded-full"></div>
            <h2 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-white">{{ section_title }}</h2>
            <span class="bg-gradient-to-r {{ badge_classes }} text-white text-sm px-3 py-1 rounded-full shadow-md font-medium">{{ books.len() }}</span>
        </div>
        <!-- Toggle Button -->
        {% include "components/toggle_button.html" %}
    </div>
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-4 md:gap-6 mb-6 md:mb-8" id="{{ section_name }}Container">
        {% for book in books %}
        <div class="book-card group shadow-lg dark:shadow-none" data-status="{{ section_name }}" data-title="{{ book.book_info.title }}" data-author="{% if !book.book_info.authors.is_empty() %}{{ book.book_info.authors[0] }}{% endif %}" data-series="{% match book.series_display() %}{% when Some with (series) %}{{ series }}{% when None %}{% endmatch %}">
            <a href="/books/{{ book.id }}/" class="block">
                <div class="aspect-book bg-gray-200 dark:bg-dark-700 relative overflow-hidden">
                    <img src="/assets/covers/{{ book.id }}.webp"
                         data-src="/assets/covers/{{ book.id }}.webp" 
                         alt="{{ book.book_info.title }}" 
                         class="w-full h-full object-cover lazy-image transition-opacity duration-500 ease-out"
                         loading="lazy"
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div class="w-full h-full flex items-center justify-center text-4xl text-gray-400 dark:text-dark-500 absolute inset-0 book-placeholder bg-gray-300 dark:bg-gray-600" style="display: flex; border: none; outline: none; text-shadow: none;">ðŸ“–</div>
                    
                    <!-- Section-specific indicators -->
                    {% if section_name == "reading" %}
                        <!-- Progress Bar -->
                        <div class="book-progress-bar progress-reading" style="width: {{ book.progress_percentage_display() }}%;"></div>
                        
                        <!-- Rating Indicator -->
                        {% include "book_list/components/overlays/rating_overlay.html" %}
                        
                        <!-- Notes Indicator for Reading -->
                        {% set notes_color_classes = "bg-gradient-to-br from-blue-500 to-blue-600 border border-blue-400/30" %}
                        {% include "book_list/components/overlays/notes_overlay.html" %}

                    {% elif section_name == "abandoned" %}
                        <!-- Progress Bar -->
                        <div class="book-progress-bar progress-reading" style="width: {{ book.progress_percentage_display() }}%;"></div>
                        
                        <!-- Rating Indicator -->
                        {% include "book_list/components/overlays/rating_overlay.html" %}

                        <!-- Notes Indicator for On Hold -->
                        {% set notes_color_classes = "bg-gradient-to-br from-purple-500 to-purple-600 border border-purple-400/30" %}
                        {% include "book_list/components/overlays/notes_overlay.html" %}

                        <!-- Pause Indicator -->
                        {% include "book_list/components/overlays/pause_overlay.html" %}

                    {% elif section_name == "completed" %}
                        <!-- Rating Indicator -->
                        {% include "book_list/components/overlays/rating_overlay.html" %}
                        
                        <!-- Notes Indicator for Completed -->
                        {% set notes_color_classes = "bg-gradient-to-br from-emerald-500 to-emerald-600 border border-emerald-400/30" %}
                        {% include "book_list/components/overlays/notes_overlay.html" %}

                    {% elif section_name == "unread" %}
                        <!-- Unread Indicator -->
                        {% include "book_list/components/overlays/unread_overlay.html" %}
                    {% endif %}
                </div>
            </a>
        </div>
        {% endfor %}
    </div>
</section> 
